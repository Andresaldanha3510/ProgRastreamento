<div id="detalhesModal" class="modal">
    <div class="modal-content extra-large">
        <div class="modal-header">
            <h2 class="modal-title"><i class="fas fa-eye"></i>Detalhes do Lançamento</h2>
            <span class="close" onclick="closeModal('detalhesModal')">&times;</span>
        </div>
        <div class="modal-body" id="detalhesContent">
            </div>
        <div class="modal-footer">
            <button type="button" class="btn-secondary" onclick="closeModal('detalhesModal')">Fechar</button>
        </div>
    </div>
</div>

<div id="pagamentoModal" class="modal">
    <div class="modal-content small">
        <div class="modal-header">
            <h2 class="modal-title"><i class="fas fa-dollar-sign"></i>Confirmar Pagamento</h2>
            <span class="close" onclick="closeModal('pagamentoModal')">&times;</span>
        </div>
        <form id="pagamentoForm">
            <div class="modal-body">
                <p>Você está prestes a marcar o lançamento como <strong>pago</strong>.</p>
                <p class="text-lg font-bold my-2" id="valorPagamentoModal"></p>
                <input type="hidden" id="itemId" name="item_id">
                <div class="form-group mt-4">
                    <label class="form-label" for="data_pagamento_modal">Data do Pagamento</label>
                    <input type="date" id="data_pagamento_modal" name="data_pagamento" class="form-control" required>
                </div>
                <div class="form-group mt-4">
                    <label class="form-label" for="meio_pagamento_modal">Forma de Pagamento</label>
                    <select id="meio_pagamento_modal" name="meio_pagamento" class="form-select" required>
                        <option value="">Selecione a forma</option>
                        <option value="PIX">PIX</option>
                        <option value="DEPOSITO">Depósito</option>
                        <option value="TRANSFERENCIA">Transferência</option>
                        <option value="DINHEIRO">Dinheiro</option>
                        <option value="CARTAO">Cartão</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" onclick="closeModal('pagamentoModal')">Cancelar</button>
                <button type="submit" class="btn-green">Confirmar Pagamento</button>
            </div>
        </form>
    </div>
</div>

<div id="edicaoModal" class="modal">
    <div class="modal-content large">
        <div class="modal-header">
            <h2 class="modal-title"><i class="fas fa-edit"></i>Editar Lançamento</h2>
            <span class="close" onclick="closeModal('edicaoModal')">&times;</span>
        </div>
        <form id="edicaoForm">
            <div class="modal-body">
                 <input type="hidden" id="lancamentoId" name="lancamento_id">
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="form-group">
                        <label class="form-label" for="tipo">Tipo</label>
                        <select id="tipo" name="tipo" class="form-select" required>
                            <option value="RECEITA">Receita</option>
                            <option value="DESPESA">Despesa</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="valor_total">Valor (R$)</label>
                        <input type="number" step="0.01" id="valor_total" name="valor_total" class="form-control" required>
                    </div>
                     <div class="form-group col-span-2">
                        <label class="form-label" for="descricao">Descrição</label>
                        <input type="text" id="descricao" name="descricao" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="categoria">Categoria</label>
                        <input type="text" id="categoria" name="categoria" class="form-control">
                    </div>
                     <div class="form-group">
                        <label class="form-label" for="data_vencimento">Data Vencimento</label>
                        <input type="date" id="data_vencimento" name="data_vencimento" class="form-control" required>
                    </div>
                     <div class="form-group">
                        <label class="form-label" for="fornecedor_cliente">Fornecedor/Cliente</label>
                        <input type="text" id="fornecedor_cliente" name="fornecedor_cliente" class="form-control">
                    </div>
                     <div class="form-group">
                        <label class="form-label" for="documento_numero">Nº Documento</label>
                        <input type="text" id="documento_numero" name="documento_numero" class="form-control">
                    </div>
                      <div class="form-group col-span-2">
                        <label class="form-label" for="observacoes">Observações</label>
                        <textarea id="observacoes" name="observacoes" class="form-control" rows="2"></textarea>
                    </div>
                 </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" onclick="closeModal('edicaoModal')">Cancelar</button>
                <button type="submit" class="btn-green">Salvar Alterações</button>
            </div>
        </form>
    </div>
</div>

<div id="confirmarExclusaoModal" class="modal">
    <div class="modal-content small">
         <div class="modal-header" style="background: linear-gradient(135deg, #c82333 0%, #dc3545 100%);">
            <h2 class="modal-title"><i class="fas fa-exclamation-triangle"></i>Confirmar Exclusão</h2>
            <span class="close" onclick="closeModal('confirmarExclusaoModal')">&times;</span>
        </div>
        <form id="exclusaoForm">
            <div class="modal-body">
                <p>Tem certeza que deseja excluir este lançamento? Esta ação não pode ser desfeita.</p>
                <input type="hidden" id="itemIdParaExcluir" name="item_id">
            </div>
             <div class="modal-footer">
                <button type="button" class="btn-secondary" onclick="closeModal('confirmarExclusaoModal')">Cancelar</button>
                <button type="submit" class="btn-danger" style="background: #dc3545; color: white;">Excluir</button>
            </div>
        </form>
    </div>
</div>

<div id="estornarPagamentoModal" class="modal">
    <div class="modal-content small">
         <div class="modal-header" style="background: linear-gradient(135deg, #5a6268 0%, #6c757d 100%);">
            <h2 class="modal-title"><i class="fas fa-undo"></i>Estornar Pagamento</h2>
            <span class="close" onclick="closeModal('estornarPagamentoModal')">&times;</span>
        </div>
        <form id="estornoForm">
            <div class="modal-body">
                <p>Você está prestes a estornar este pagamento, marcando-o novamente como pendente. Deseja continuar?</p>
                <input type="hidden" id="itemIdParaEstornar" name="item_id">
                 <div class="form-group mt-4">
                    <label class="form-label" for="motivo_estorno">Motivo (Opcional)</label>
                    <input type="text" id="motivo_estorno" name="motivo" class="form-control" placeholder="Ex: Pagamento duplicado">
                </div>
            </div>
             <div class="modal-footer">
                <button type="button" class="btn-secondary" onclick="closeModal('estornarPagamentoModal')">Cancelar</button>
                <button type="submit" class="btn-warning" style="background:#6c757d; color:white;">Confirmar Estorno</button>
            </div>
        </form>
    </div>
</div>

<div id="duplicarLancamentoModal" class="modal">
    <div class="modal-content small">
        <div class="modal-header" style="background: linear-gradient(135deg, #0069d9 0%, #007bff 100%);">
            <h2 class="modal-title"><i class="fas fa-copy"></i>Duplicar Lançamento</h2>
            <span class="close" onclick="closeModal('duplicarLancamentoModal')">&times;</span>
        </div>
        <form id="duplicarForm">
            <div class="modal-body">
                <p>Uma cópia deste lançamento será criada. Informe a nova data de vencimento.</p>
                <input type="hidden" id="itemIdParaDuplicar" name="item_id">
                <div class="form-group mt-4">
                    <label class="form-label" for="nova_data_vencimento_duplicar">Nova Data de Vencimento</label>
                    <input type="date" id="nova_data_vencimento_duplicar" name="nova_data_vencimento" class="form-control" required>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" onclick="closeModal('duplicarLancamentoModal')">Cancelar</button>
                <button type="submit" class="btn-primary" style="background:#007bff; color:white;">Duplicar</button>
            </div>
        </form>
    </div>
</div>

<div id="alterarCategoriaMassaModal" class="modal">
    <div class="modal-content small">
        <div class="modal-header">
            <h2 class="modal-title"><i class="fas fa-tags"></i>Alterar Categoria em Massa</h2>
            <span class="close" onclick="closeModal('alterarCategoriaMassaModal')">&times;</span>
        </div>
        <form id="alterarCategoriaMassaForm">
            <div class="modal-body">
                <p>Selecione a nova categoria para os <strong id="contadorModalCategoria"></strong> itens selecionados.</p>
                <div class="form-group mt-4">
                    <label class="form-label" for="nova_categoria_massa">Nova Categoria</label>
                    <select id="nova_categoria_massa" name="nova_categoria" class="form-select" required>
                        {% for categoria in categorias %}
                            <option value="{{ categoria }}">{{ categoria }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" onclick="closeModal('alterarCategoriaMassaModal')">Cancelar</button>
                <button type="submit" class="btn-green">Aplicar</button>
            </div>
        </form>
    </div>
</div>

<div id="novoLancamentoModal" class="modal">
    <div class="modal-content large">
        </div>
</div>