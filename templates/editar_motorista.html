{% extends "base.html" %} {% block title %}Editar Motorista - {{ motorista.nome
}}{% endblock %} {% block styles %} {{ super() }}
<style>
  /* Estilos padronizados, idênticos aos de 'editar_cliente.html' */
  :root {
    --primary-green: #2e7d32;
    --primary-green-dark: #1b5e20;
    --gray-50: #f8fafc;
    --gray-100: #f1f5f9;
    --gray-200: #e2e8f0;
    --gray-600: #475569;
    --gray-700: #334155;
    --gray-900: #0f172a;
    --red-600: #dc2626;
  }
  .form-container,
  .kpi-container {
    background: linear-gradient(135deg, var(--gray-50) 0%, #ffffff 100%);
    border-radius: 16px;
    padding: 2rem;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
    border: 1px solid var(--gray-200);
  }
  .form-section-header {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--primary-green-dark);
    border-bottom: 2px solid var(--primary-green);
    padding-bottom: 0.5rem;
    margin-bottom: 1.5rem;
    display: flex;
    align-items: center;
    gap: 0.75rem;
  }
  .form-input,
  .form-select {
    width: 100%;
    padding: 0.75rem 1rem;
    border: 2px solid var(--gray-200);
    border-radius: 8px;
    font-size: 1rem;
    transition: all 0.3s;
    background: white;
  }
  .form-input[type="date"] {
    color-scheme: light;
  }
  .form-input:focus,
  .form-select:focus {
    outline: none;
    border-color: var(--primary-green);
    box-shadow: 0 0 0 3px rgba(46, 125, 50, 0.1);
  }
  label {
    display: block;
    margin-bottom: 0.25rem;
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--gray-700);
  }
  .tab-link {
    padding: 0.75rem 1.25rem;
    border: none;
    background: none;
    cursor: pointer;
    font-weight: 500;
    color: var(--gray-600);
    border-bottom: 3px solid transparent;
    transition: all 0.3s;
  }
  .tab-link.active {
    color: var(--primary-green-dark);
    border-bottom-color: var(--primary-green);
  }
  .tab-content {
    display: none;
  }
  .tab-content.active {
    display: block;
    animation: fadeIn 0.5s;
  }
  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  .btn-green {
    background: linear-gradient(
      135deg,
      var(--primary-green) 0%,
      var(--primary-green-dark) 100%
    );
    color: white;
    padding: 12px 24px;
    border: none;
    border-radius: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
    display: inline-flex;
    align-items: center;
    gap: 8px;
    box-shadow: 0 4px 12px rgba(46, 125, 50, 0.3);
    text-decoration: none;
  }
  .btn-green:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(46, 125, 50, 0.4);
    color: white;
    text-decoration: none;
  }
  .btn-secondary {
    background-color: var(--gray-200);
    color: var(--gray-700);
    padding: 12px 24px;
    border: none;
    border-radius: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
    text-decoration: none;
  }
  .btn-secondary:hover {
    background-color: #d1d5db;
  }
  #drop-zone {
    border: 2px dashed #cbd5e1;
    border-radius: 0.75rem;
    padding: 2.5rem;
    text-align: center;
    color: #64748b;
    transition: all 0.3s ease;
    cursor: pointer;
    background-color: #f8fafc;
  }
  #drop-zone.drag-over {
    border-color: var(--primary-green);
    background-color: #f0fdf4;
    color: #166534;
  }
  #drop-zone i {
    font-size: 3rem;
    margin-bottom: 1rem;
  }
  .file-item {
    display: flex;
    align-items: center;
    padding: 0.75rem;
    background-color: #f8fafc;
    border: 1px solid #e2e8f0;
    border-radius: 0.5rem;
    margin-top: 0.75rem;
    position: relative;
    overflow: hidden;
  }
  .file-preview {
    width: 48px;
    height: 48px;
    border-radius: 0.375rem;
    background-color: #e2e8f0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    color: #64748b;
    margin-right: 1rem;
    flex-shrink: 0;
  }
  .file-preview img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 0.375rem;
  }
  .file-details {
    flex-grow: 1;
    overflow: hidden;
  }
  .file-name {
    font-weight: 500;
    color: var(--gray-900);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    text-decoration: none;
  }
  .file-name:hover {
    text-decoration: underline;
    color: var(--primary-green);
  }
  .file-size {
    font-size: 0.875rem;
    color: var(--gray-600);
  }
  .file-actions {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-left: 1rem;
  }
  .file-status-icon {
    font-size: 1.25rem;
  }
  .status-uploading {
    color: var(--gray-600);
    animation: spin 1s linear infinite;
  }
  .status-success {
    color: #22c55e;
  }
  .status-error {
    color: var(--red-600);
  }
  .btn-icon {
    background: none;
    border: none;
    cursor: pointer;
    padding: 0.5rem;
    border-radius: 50%;
    color: #94a3b8;
    transition: all 0.2s;
  }
  .btn-icon:hover {
    background-color: var(--gray-100);
    color: var(--gray-700);
  }
  .btn-icon-delete:hover {
    background-color: #fee2e2;
    color: var(--red-600);
  }
  .progress-bar {
    position: absolute;
    bottom: 0;
    left: 0;
    height: 4px;
    background-color: #3b82f6;
    width: 0%;
    transition: width 0.3s ease;
  }
  .file-item.error .progress-bar {
    background-color: var(--red-600);
  }
  .file-item.success .progress-bar {
    background-color: #22c55e;
  }
  @keyframes spin {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }
</style>
{% endblock %} {% block content %}
<div class="space-y-6">
  <div
    class="bg-gradient-to-r from-green-600 to-green-700 text-white rounded-lg p-6 shadow-lg"
  >
    <h1 class="text-3xl font-bold flex items-center gap-3">
      <i class="fas fa-user-edit"></i>
      Editar Motorista
    </h1>
    <p class="text-green-100 mt-2">
      Atualize as informações de
      <span class="font-semibold">{{ motorista.nome }}</span>
    </p>
  </div>

  <div class="kpi-container">
    <h2 class="form-section-header">
      <i class="fas fa-chart-line"></i>Desempenho Geral
    </h2>
    <div
      id="kpi-content"
      class="grid grid-cols-1 md:grid-cols-3 gap-6 text-center"
    >
      <div class="bg-gray-100 p-4 rounded-lg animate-pulse">
        <p class="h-6 bg-gray-300 rounded"></p>
        <p class="h-4 mt-2 bg-gray-300 rounded w-2/3 mx-auto"></p>
      </div>
      <div class="bg-gray-100 p-4 rounded-lg animate-pulse">
        <p class="h-6 bg-gray-300 rounded"></p>
        <p class="h-4 mt-2 bg-gray-300 rounded w-2/3 mx-auto"></p>
      </div>
      <div class="bg-gray-100 p-4 rounded-lg animate-pulse">
        <p class="h-6 bg-gray-300 rounded"></p>
        <p class="h-4 mt-2 bg-gray-300 rounded w-2/3 mx-auto"></p>
      </div>
    </div>
  </div>

  <form
    id="motorista-form"
    method="POST"
    action="{{ url_for('editar_motorista', motorista_id=motorista.id) }}"
    novalidate
    class="form-container"
  >
    <div class="flex border-b-2 border-gray-200 mb-6">
      <button
        type="button"
        class="tab-link active"
        onclick="openTab(event, 'pessoais')"
      >
        Dados Pessoais
      </button>
      <button
        type="button"
        class="tab-link"
        onclick="openTab(event, 'endereco')"
      >
        Endereço
      </button>
      <button
        type="button"
        class="tab-link"
        onclick="openTab(event, 'documentacao')"
      >
        Documentação
      </button>
      <button
        type="button"
        class="tab-link"
        onclick="openTab(event, 'contatos')"
      >
        Contato
      </button>
    </div>

    <div id="pessoais" class="tab-content active">
      <h2 class="form-section-header">
        <i class="fas fa-user"></i>Informações Pessoais
      </h2>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
        <div>
          <label for="nome">Nome Completo*</label>
          <input
            type="text"
            name="nome"
            id="nome"
            required
            class="form-input"
            value="{{ motorista.nome or '' }}"
          />
        </div>
        <div>
          <label for="cpf">CPF*</label>
          <input
            type="text"
            name="cpf"
            id="cpf"
            required
            class="form-input"
            value="{{ motorista.cpf or '' }}"
          />
        </div>
        <div>
          <label for="data_nascimento">Data de Nascimento</label>
          <input
            type="date"
            name="data_nascimento"
            id="data_nascimento"
            class="form-input"
            value="{{ motorista.data_nascimento|dateformat }}"
          />
        </div>
        <div>
          <label for="telefone">Telefone</label>
          <input
            type="text"
            name="telefone"
            id="telefone"
            class="form-input"
            value="{{ motorista.telefone or '' }}"
          />
        </div>
        <div>
          <label for="email">E-mail</label>
          <input
            type="email"
            name="email"
            id="email"
            class="form-input"
            value="{{ motorista.email or '' }}"
          />
        </div>
        <div>
          <label for="data_admissao">Data de Admissão</label>
          <input
            type="date"
            name="data_admissao"
            id="data_admissao"
            class="form-input"
            value="{{ motorista.data_admissao|dateformat }}"
          />
        </div>
        <div>
          <label for="funcao">Função</label>
          <input
            type="text"
            name="funcao"
            id="funcao"
            class="form-input"
            value="{{ motorista.funcao or '' }}"
          />
        </div>
        <div>
          <label for="salario_base">Salário Base (R$)</label>
          <input
            type="number"
            step="0.01"
            name="salario_base"
            id="salario_base"
            class="form-input"
            value="{{ motorista.salario_base or '' }}"
          />
        </div>
      </div>
    </div>
    <div id="endereco" class="tab-content">
      <h2 class="form-section-header">
        <i class="fas fa-map-marked-alt"></i>Endereço
      </h2>
      <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
        <div class="md:col-span-1">
          <label for="cep">CEP</label>
          <input
            type="text"
            name="cep"
            id="cep"
            class="form-input"
            value="{{ motorista.cep or '' }}"
          />
        </div>
        <div class="md:col-span-3">
          <label for="logradouro">Logradouro</label>
          <input
            type="text"
            name="logradouro"
            id="logradouro"
            class="form-input"
            value="{{ motorista.logradouro or '' }}"
          />
        </div>
        <div>
          <label for="numero">Número</label>
          <input
            type="text"
            name="numero"
            id="numero"
            class="form-input"
            value="{{ motorista.numero or '' }}"
          />
        </div>
        <div>
          <label for="complemento">Complemento</label>
          <input
            type="text"
            name="complemento"
            id="complemento"
            class="form-input"
            value="{{ motorista.complemento or '' }}"
          />
        </div>
        <div class="md:col-span-2">
          <label for="bairro">Bairro</label>
          <input
            type="text"
            name="bairro"
            id="bairro"
            class="form-input"
            value="{{ motorista.bairro or '' }}"
          />
        </div>
        <div class="md:col-span-2">
          <label for="cidade">Cidade</label>
          <input
            type="text"
            name="cidade"
            id="cidade"
            class="form-input"
            value="{{ motorista.cidade or '' }}"
          />
        </div>
        <div class="md:col-span-2">
          <label for="uf">UF</label>
          <input
            type="text"
            name="uf"
            id="uf"
            class="form-input"
            maxlength="2"
            value="{{ motorista.uf or '' }}"
          />
        </div>
      </div>
    </div>
    <div id="documentacao" class="tab-content">
      <h2 class="form-section-header">
        <i class="fas fa-id-card-alt"></i>Documentos
      </h2>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
        <div>
          <label for="rg">RG</label>
          <input
            type="text"
            name="rg"
            id="rg"
            class="form-input"
            value="{{ motorista.rg or '' }}"
          />
        </div>
        <div>
          <label for="rg_uf">UF do RG</label>
          <input
            type="text"
            name="rg_uf"
            id="rg_uf"
            class="form-input"
            maxlength="2"
            value="{{ motorista.rg_uf or '' }}"
          />
        </div>
        <div>
          <label for="cnh_numero">Número CNH*</label>
          <input
            type="text"
            name="cnh_numero"
            id="cnh_numero"
            required
            class="form-input"
            value="{{ motorista.cnh_numero or '' }}"
          />
        </div>
        <div>
          <label for="cnh_categoria">Categoria CNH</label>
          <input
            type="text"
            name="cnh_categoria"
            id="cnh_categoria"
            class="form-input"
            value="{{ motorista.cnh_categoria or '' }}"
          />
        </div>
        <div>
          <label for="cnh_data_vencimento">Vencimento CNH</label>
          <input
            type="date"
            name="cnh_data_vencimento"
            id="cnh_data_vencimento"
            class="form-input"
            value="{{ motorista.cnh_data_vencimento|dateformat }}"
          />
        </div>
        <div>
          <label for="mopp_vencimento">Vencimento MOPP</label>
          <input
            type="date"
            name="mopp_vencimento"
            id="mopp_vencimento"
            class="form-input"
            value="{{ motorista.mopp_vencimento|dateformat }}"
          />
        </div>
      </div>
    </div>
    <div id="contatos" class="tab-content">
      <h2 class="form-section-header">
        <i class="fas fa-address-book"></i>Contatos de Referência
      </h2>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
        <div>
          <label for="contato_nome">Nome do Contato</label>
          <input
            type="text"
            name="contato_nome"
            id="contato_nome"
            class="form-input"
            value="{{ motorista.contato_nome or '' }}"
          />
        </div>
        <div>
          <label for="contato_telefone">Telefone do Contato</label>
          <input
            type="text"
            name="contato_telefone"
            id="contato_telefone"
            class="form-input"
            value="{{ motorista.contato_telefone or '' }}"
          />
        </div>
        <div class="sm:col-span-2 lg:col-span-3">
          <label for="contato_obs">Observações</label>
          <input
            type="text"
            name="contato_obs"
            id="contato_obs"
            class="form-input"
            value="{{ motorista.contato_obs or '' }}"
          />
        </div>
      </div>
    </div>
    <div class="mt-8 flex justify-end gap-4">
      <a href="{{ url_for('consultar_motoristas') }}" class="btn-secondary"
        >Voltar</a
      >
      <button type="submit" class="btn-green">
        <i class="fas fa-save mr-2"></i>
        Salvar Alterações
      </button>
    </div>
  </form>

  <div class="form-container">
    <h2 class="form-section-header">
      <i class="fas fa-paperclip"></i>Central de Anexos
    </h2>
    <div id="drop-zone">
      <i class="fas fa-cloud-upload-alt"></i>
      <p class="font-semibold">Arraste e solte os arquivos aqui</p>
      <p class="text-sm">ou</p>
      <button
        type="button"
        onclick="document.getElementById('file-input').click()"
        class="mt-2 bg-white text-gray-700 font-semibold py-2 px-4 border border-gray-300 rounded-lg hover:bg-gray-50"
      >
        Selecione os Arquivos
      </button>
    </div>
    <input type="file" id="file-input" multiple class="hidden" />
    <div id="file-list" class="mt-4"></div>
  </div>
</div>
{% endblock %} {% block scripts %} {{ super() }}
<script>
  // --- SCRIPTS DE UI (ABAS, MÁSCARAS, ETC) ---
  function openTab(event, tabName) {
      document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
      document.querySelectorAll('.tab-link').forEach(link => link.classList.remove('active'));
      document.getElementById(tabName).classList.add('active');
      event.currentTarget.classList.add('active');
  }
  document.addEventListener('DOMContentLoaded', function () {
      // Lógica de máscaras (exemplo para CPF, pode adicionar mais)
      const cpfInput = document.getElementById('cpf');
      if (cpfInput) {
          cpfInput.addEventListener('input', (e) => {
              e.target.value = e.target.value.replace(/\D/g, '');
          });
      }
  });

  // --- SCRIPT PARA CARREGAR KPIs ---
  async function loadKpis() {
      const kpiContainer = document.getElementById('kpi-content');
      try {
          const response = await fetch(`/api/motorista/{{ motorista.id }}/kpis`);
          const data = await response.json();
          if (data.success) {
              const kpis = data.kpis;
              kpiContainer.innerHTML = `
                  <div class="bg-blue-100 p-4 rounded-lg">
                      <p class="text-2xl font-bold text-blue-800">${kpis.total_viagens}</p>
                      <p class="text-sm text-blue-600">Total de Viagens</p>
                  </div>
                  <div class="bg-purple-100 p-4 rounded-lg">
                      <p class="text-2xl font-bold text-purple-800">${kpis.total_distancia.toLocaleString('pt-BR')} km</p>
                      <p class="text-sm text-purple-600">Distância Percorrida</p>
                  </div>
                  <div class="bg-green-100 p-4 rounded-lg">
                      <p class="text-2xl font-bold text-green-800">R$ ${kpis.total_receita.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</p>
                      <p class="text-sm text-green-600">Receita Gerada</p>
                  </div>
              `;
          } else {
              kpiContainer.innerHTML = '<p class="text-red-500 col-span-3">Não foi possível carregar os indicadores.</p>';
          }
      } catch (error) {
          kpiContainer.innerHTML = '<p class="text-red-500 col-span-3">Erro de conexão ao buscar indicadores.</p>';
      }
  }

  // --- SCRIPT DA CENTRAL DE ANEXOS ---
  const dropZone = document.getElementById('drop-zone');
  const fileInput = document.getElementById('file-input');
  const fileList = document.getElementById('file-list');
  const motoristaId = {{ motorista.id }};
  const existingFiles = {{ (motorista.anexos.split(',') if motorista.anexos else [])|tojson }};
  const activeUploads = {};

  dropZone.addEventListener('dragover', (e) => { e.preventDefault(); dropZone.classList.add('drag-over'); });
  dropZone.addEventListener('dragleave', () => { dropZone.classList.remove('drag-over'); });
  dropZone.addEventListener('drop', (e) => { e.preventDefault(); dropZone.classList.remove('drag-over'); handleFiles(e.dataTransfer.files); });
  fileInput.addEventListener('change', () => handleFiles(fileInput.files));

  function handleFiles(files) {
      [...files].forEach(file => {
          const fileId = `file-${Date.now()}${Math.floor(Math.random() * 1000)}`;
          const fileElement = createFileElement(fileId, file);
          fileList.prepend(fileElement);
          uploadFile(fileId, file);
      });
      fileInput.value = '';
  }

  function createFileElement(fileId, file, existingUrl = null) {
      const fileElement = document.createElement('div');
      fileElement.className = 'file-item';
      fileElement.id = fileId;
      const isImage = file ? file.type.startsWith('image/') : false;
      const fileName = file ? file.name : (existingUrl.split('/').pop().split('-').slice(1).join('-') || 'Arquivo');
      const fileSize = file ? (file.size / 1024 / 1024).toFixed(2) + ' MB' : '';
      fileElement.innerHTML = `
          <div class="file-preview">${isImage ? `<img id="preview-${fileId}" src="" alt="preview">` : '<i class="fas fa-file-alt"></i>'}</div>
          <div class="file-details">
              <a href="${existingUrl || '#'}" target="_blank" class="file-name" title="${fileName}">${fileName}</a>
              <div class="file-size">${fileSize}</div>
          </div>
          <div class="file-actions">
              <i id="status-${fileId}" class="file-status-icon"></i>
              <button id="action-${fileId}" class="btn-icon"></button>
          </div>
          <div id="progress-${fileId}" class="progress-bar"></div>`;
      if (isImage && file) {
          const reader = new FileReader();
          reader.onload = (e) => { document.getElementById(`preview-${fileId}`).src = e.target.result; };
          reader.readAsDataURL(file);
      }
      if (existingUrl) { fileElement.dataset.url = existingUrl; }
      return fileElement;
  }

  function uploadFile(fileId, file) {
      const formData = new FormData();
      formData.append('file', file);
      const xhr = new XMLHttpRequest();
      activeUploads[fileId] = xhr;
      xhr.open('POST', `/api/motorista/${motoristaId}/upload_anexo`, true);
      xhr.upload.onprogress = (e) => { if (e.lengthComputable) { updateProgressBar(fileId, (e.loaded / e.total) * 100); } };
      xhr.onload = () => {
          delete activeUploads[fileId];
          if (xhr.status === 200) {
              const response = JSON.parse(xhr.responseText);
              document.querySelector(`#${fileId} .file-name`).href = response.file_url;
              document.getElementById(fileId).dataset.url = response.file_url;
              setFileState(fileId, 'success');
          } else { setFileState(fileId, 'error', 'Falha no upload'); }
      };
      xhr.onerror = () => { delete activeUploads[fileId]; setFileState(fileId, 'error', 'Erro de conexão'); };
      xhr.onabort = () => { delete activeUploads[fileId]; document.getElementById(fileId).remove(); }
      setFileState(fileId, 'uploading');
      xhr.send(formData);
  }

  async function deleteFile(fileId) {
      const fileElement = document.getElementById(fileId);
      const fileUrl = fileElement.dataset.url;
      if (!fileUrl || !confirm('Tem certeza que deseja excluir este anexo permanentemente?')) return;
      try {
          const response = await fetch('/api/motorista/excluir_anexo', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ motorista_id: motoristaId, anexo_url: fileUrl })
          });
          const result = await response.json();
          if (result.success) { fileElement.remove(); }
          else { alert('Erro ao excluir: ' + result.message); }
      } catch (error) { alert('Erro de conexão ao tentar excluir o arquivo.'); }
  }

  function updateProgressBar(fileId, percent) {
      const progressBar = document.getElementById(`progress-${fileId}`);
      if (progressBar) progressBar.style.width = `${percent}%`;
  }

  function setFileState(fileId, state, message = '') {
      const statusIcon = document.getElementById(`status-${fileId}`);
      const actionButton = document.getElementById(`action-${fileId}`);
      const progressBar = document.getElementById(`progress-${fileId}`);
      if (!statusIcon || !actionButton || !progressBar) return;
      statusIcon.className = 'file-status-icon';
      actionButton.innerHTML = '';
      actionButton.onclick = null;
      switch (state) {
          case 'uploading':
              statusIcon.classList.add('fas', 'fa-spinner', 'status-uploading');
              actionButton.innerHTML = '<i class="fas fa-times"></i>';
              actionButton.title = 'Cancelar Upload';
              actionButton.onclick = () => activeUploads[fileId]?.abort();
              break;
          case 'success':
              statusIcon.classList.add('fas', 'fa-check-circle', 'status-success');
              progressBar.style.width = '100%';
              actionButton.innerHTML = '<i class="fas fa-trash-alt"></i>';
              actionButton.title = 'Excluir Arquivo';
              actionButton.classList.add('btn-icon-delete');
              actionButton.onclick = () => deleteFile(fileId);
              break;
          case 'error':
              statusIcon.classList.add('fas', 'fa-exclamation-circle', 'status-error');
              progressBar.style.width = '100%';
              document.getElementById(fileId).classList.add('error');
              actionButton.innerHTML = '<i class="fas fa-trash-alt"></i>';
              actionButton.title = 'Remover da lista';
              actionButton.classList.add('btn-icon-delete');
              actionButton.onclick = () => document.getElementById(fileId).remove();
              document.querySelector(`#${fileId} .file-size`).textContent = message;
              break;
      }
  }

  function loadInitialFiles() {
      existingFiles.forEach(url => {
          if(!url) return;
          const safeIdPart = btoa(url).replace(/[/+=]/g, '');
          const fileId = `file-existing-${safeIdPart}`;
          const fileElement = createFileElement(fileId, null, url);
          fileList.appendChild(fileElement);
          setFileState(fileId, 'success');
      });
  }

  // Inicia a página
  document.addEventListener('DOMContentLoaded', () => {
      loadInitialFiles();
      loadKpis();
  });
</script>
{% endblock %}
